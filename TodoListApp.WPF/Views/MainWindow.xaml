<Window x:Class="TodoListApp.WPF.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="TODO List - Главная" Height="700" Width="1200"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource MaterialDesignPaper}">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="300"/>
        </Grid.ColumnDefinitions>

        <!-- Left Sidebar - Categories -->
        <Border Grid.Column="0" 
                Background="{DynamicResource MaterialDesignDivider}"
                BorderThickness="0,0,1,0"
                BorderBrush="{DynamicResource MaterialDesignDivider}">
            <StackPanel Margin="10">
                <TextBlock Text="TODO List" 
                           FontSize="24" 
                           FontWeight="Bold"
                           Margin="10,10,10,20"
                           Foreground="{DynamicResource PrimaryHueMidBrush}"/>

                <Button Content="Все задачи"
                        Style="{StaticResource MaterialDesignFlatButton}"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Left"
                        Margin="0,5"/>

                <Button Content="Новые"
                        Style="{StaticResource MaterialDesignFlatButton}"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Left"
                        Margin="0,5"/>

                <Button Content="В процессе"
                        Style="{StaticResource MaterialDesignFlatButton}"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Left"
                        Margin="0,5"/>

                <Button Content="Выполненные"
                        Style="{StaticResource MaterialDesignFlatButton}"
                        HorizontalAlignment="Stretch"
                        HorizontalContentAlignment="Left"
                        Margin="0,5"/>

                <Separator Margin="0,20"/>

                <TextBlock Text="Категории" 
                           FontSize="16" 
                           FontWeight="SemiBold"
                           Margin="10,10,10,10"/>

                <ItemsControl ItemsSource="{Binding Categories}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Button Content="{Binding Name}"
                                    Style="{StaticResource MaterialDesignFlatButton}"
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Left"
                                    Margin="0,2">
                                <Button.ContentTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal">
                                            <Ellipse Width="12" Height="12" 
                                                     Fill="{Binding Color}"
                                                     Margin="0,0,10,0"/>
                                            <TextBlock Text="{Binding}"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </Button.ContentTemplate>
                            </Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </Border>

        <!-- Center - Task List -->
        <Grid Grid.Column="1" Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Toolbar -->
            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
                <Button Content="Создать задачу"
                        Command="{Binding CreateTaskCommand}"
                        Style="{StaticResource MaterialDesignRaisedButton}"
                        Margin="0,0,10,0"/>

                <Button Content="Обновить"
                        Command="{Binding RefreshCommand}"
                        Style="{StaticResource MaterialDesignOutlinedButton}"
                        Margin="0,0,10,0"/>
            </StackPanel>

            <!-- Search -->
            <TextBox Grid.Row="1"
                     materialDesign:HintAssist.Hint="Поиск задач..."
                     Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                     Style="{StaticResource MaterialDesignOutlinedTextBox}"
                     Margin="0,0,0,15"/>

            <!-- Task List -->
            <ListView Grid.Row="2"
                      ItemsSource="{Binding Tasks}"
                      SelectedItem="{Binding SelectedTask}">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <Border BorderThickness="0,0,0,1" 
                                BorderBrush="{DynamicResource MaterialDesignDivider}"
                                Padding="10"
                                Margin="0,5">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="{Binding Title}" 
                                               FontSize="16" 
                                               FontWeight="SemiBold"
                                               TextWrapping="Wrap"/>
                                    
                                    <TextBlock Text="{Binding Description}" 
                                               FontSize="13"
                                               Foreground="{DynamicResource MaterialDesignBodyLight}"
                                               TextWrapping="Wrap"
                                               Margin="0,5,0,0"
                                               MaxHeight="40"/>

                                    <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                        <Border Background="{DynamicResource PrimaryHueLightBrush}"
                                                CornerRadius="3"
                                                Padding="8,3"
                                                Margin="0,0,5,0">
                                            <TextBlock Text="{Binding Priority}" 
                                                       FontSize="11"
                                                       Foreground="White"/>
                                        </Border>

                                        <Border Background="{DynamicResource SecondaryHueLightBrush}"
                                                CornerRadius="3"
                                                Padding="8,3"
                                                Margin="0,0,5,0">
                                            <TextBlock Text="{Binding Status}" 
                                                       FontSize="11"
                                                       Foreground="White"/>
                                        </Border>

                                        <TextBlock Text="{Binding DueDate, StringFormat='Срок: {0:dd.MM.yyyy}'}" 
                                                   FontSize="11"
                                                   VerticalAlignment="Center"
                                                   Margin="5,0,0,0"
                                                   Foreground="{DynamicResource MaterialDesignBodyLight}"/>
                                    </StackPanel>
                                </StackPanel>

                                <StackPanel Grid.Column="1" 
                                            Orientation="Horizontal"
                                            VerticalAlignment="Top">
                                    <Button Style="{StaticResource MaterialDesignIconButton}"
                                            ToolTip="Редактировать"
                                            Command="{Binding DataContext.EditTaskCommand, RelativeSource={RelativeSource AncestorType=ListView}}"
                                            Margin="5,0">
                                        <materialDesign:PackIcon Kind="Pencil"/>
                                    </Button>

                                    <Button Style="{StaticResource MaterialDesignIconButton}"
                                            ToolTip="Удалить"
                                            Command="{Binding DataContext.DeleteTaskCommand, RelativeSource={RelativeSource AncestorType=ListView}}"
                                            Margin="5,0">
                                        <materialDesign:PackIcon Kind="Delete"/>
                                    </Button>

                                    <Button Style="{StaticResource MaterialDesignIconButton}"
                                            ToolTip="Завершить"
                                            Command="{Binding DataContext.CompleteTaskCommand, RelativeSource={RelativeSource AncestorType=ListView}}"
                                            Margin="5,0">
                                        <materialDesign:PackIcon Kind="Check"/>
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </Grid>

        <!-- Right Sidebar - Statistics -->
        <Border Grid.Column="2" 
                Background="{DynamicResource MaterialDesignDivider}"
                BorderThickness="1,0,0,0"
                BorderBrush="{DynamicResource MaterialDesignDivider}">
            <StackPanel Margin="20">
                <TextBlock Text="Статистика" 
                           FontSize="20" 
                           FontWeight="Bold"
                           Margin="0,0,0,20"/>

                <Border Background="{DynamicResource PrimaryHueLightBrush}"
                        CornerRadius="8"
                        Padding="15"
                        Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="Всего задач" 
                                   FontSize="14"
                                   Foreground="White"/>
                        <TextBlock Text="{Binding Statistics[Total]}" 
                                   FontSize="32"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                    </StackPanel>
                </Border>

                <Border Background="{DynamicResource SecondaryHueLightBrush}"
                        CornerRadius="8"
                        Padding="15"
                        Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="Выполнено" 
                                   FontSize="14"
                                   Foreground="White"/>
                        <TextBlock Text="{Binding Statistics[Completed]}" 
                                   FontSize="32"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                    </StackPanel>
                </Border>

                <Border Background="#FF9800"
                        CornerRadius="8"
                        Padding="15"
                        Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="В процессе" 
                                   FontSize="14"
                                   Foreground="White"/>
                        <TextBlock Text="{Binding Statistics[InProgress]}" 
                                   FontSize="32"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                    </StackPanel>
                </Border>

                <Border Background="#F44336"
                        CornerRadius="8"
                        Padding="15"
                        Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="Просрочено" 
                                   FontSize="14"
                                   Foreground="White"/>
                        <TextBlock Text="{Binding Statistics[Overdue]}" 
                                   FontSize="32"
                                   FontWeight="Bold"
                                   Foreground="White"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </Border>
    </Grid>
</Window>
